if(typeof akeeba==="undefined"){var akeeba={}}if(typeof akeeba.Transfer==="undefined"){akeeba.Transfer={lastUrl:"",lastResult:"",FtpTest:{},SftpTest:{},FtpModal:null,URLs:{},translations:{}}}akeeba.Transfer.onUrlChange=function(d){if(d===undefined){d=false}var c=document.getElementById("akeeba-transfer-url");var b=c.value;if(b==""){document.getElementById("akeeba-transfer-lbl-url").style.display="block"}if((b.substring(0,7)!="http://")&&(b.substring(0,8)!="https://")){b="http://"+b}if(!d&&(b===akeeba.Transfer.lastUrl)){akeeba.Transfer.applyUrlCheck({status:akeeba.Transfer.lastResult,url:akeeba.Transfer.lastUrl});return}var a=document.querySelectorAll("#akeeba-transfer-row-url > div");for(i=0;i<a.length;i++){a[i].style.display="none"}c.setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-btn-url").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-loading").style.display="inline-block";akeeba.System.doAjax({task:"checkUrl",url:b},akeeba.Transfer.applyUrlCheck,function(e){c.removeAttribute("disabled");document.getElementById("akeeba-transfer-btn-url").removeAttribute("disabled");document.getElementById("akeeba-transfer-loading").style.display="none"},false,10000);return false};akeeba.Transfer.applyUrlCheck=function(a){var b=document.getElementById("akeeba-transfer-url");b.removeAttribute("disabled");document.getElementById("akeeba-transfer-btn-url").removeAttribute("disabled");document.getElementById("akeeba-transfer-loading").style.display="none";document.getElementById("akeeba-transfer-ftp-container").style.display="none";b.value=a.url;akeeba.Transfer.lastResult=a.status;akeeba.Transfer.lastUrl=a.url;switch(a.status){case"ok":akeeba.Transfer.showConnectionDetails();break;case"same":document.getElementById("akeeba-transfer-err-url-same").style.display="block";break;case"invalid":document.getElementById("akeeba-transfer-err-url-invalid").style.display="block";break;case"notexists":document.getElementById("akeeba-transfer-err-url-notexists").style.display="block";break}};akeeba.Transfer.showConnectionDetails=function(){document.getElementById("akeeba-transfer-url").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-btn-url").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-err-url-notexists").style.display="none";document.getElementById("akeeba-transfer-ftp-container").style.display="grid";akeeba.Transfer.onTransferMethodChange();return false};akeeba.Transfer.onTransferMethodChange=function(a){var b=document.getElementById("akeeba-transfer-ftp-method");var c=b.options[b.selectedIndex].value;document.getElementById("akeeba-transfer-ftp-host").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-port").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-username").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-password").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-pubkey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-privatekey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-directory").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-passive-container").style.display="none";document.getElementById("akeeba-transfer-ftp-passive-fix-container").style.display="none";document.getElementById("akeeba-transfer-chunkmode").parentNode.style.display="none";document.getElementById("akeeba-transfer-chunksize").parentNode.style.display="none";document.getElementById("akeeba-transfer-apply-loading").style.display="none";if(c!=="manual"){document.getElementById("akeeba-transfer-ftp-host").parentNode.style.display="grid";document.getElementById("akeeba-transfer-ftp-port").parentNode.style.display="grid";document.getElementById("akeeba-transfer-ftp-username").parentNode.style.display="grid";document.getElementById("akeeba-transfer-ftp-password").parentNode.style.display="grid";document.getElementById("akeeba-transfer-ftp-directory").parentNode.style.display="grid";document.getElementById("akeeba-transfer-chunkmode").parentNode.style.display="grid";document.getElementById("akeeba-transfer-chunksize").parentNode.style.display="grid"}if(c==="manual"){document.getElementById("akeeba-transfer-btn-apply").parentNode.style.display="none";document.getElementById("akeeba-transfer-manualtransfer").style.display="grid";return}if((c==="ftp")||(c==="ftps")||(c==="ftpcurl")||(c==="ftpscurl")){document.getElementById("akeeba-transfer-ftp-passive-container").style.display="grid"}if((c==="ftpcurl")||(c==="ftpscurl")){document.getElementById("akeeba-transfer-ftp-passive-fix-container").style.display="grid"}if((c==="sftp")||(c==="sftpcurl")){document.getElementById("akeeba-transfer-ftp-pubkey").parentNode.style.display="grid";document.getElementById("akeeba-transfer-ftp-privatekey").parentNode.style.display="grid"}};akeeba.Transfer.applyConnection=function(){document.getElementById("akeeba-transfer-ftp-error").style.display="none";document.getElementById("akeeba-transfer-apply-loading").style.display="block";var a=document.getElementById("akeeba-transfer-btn-apply");a.setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-ftp-method").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-ftp-host").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-port").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-username").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-password").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-pubkey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-privatekey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-directory").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-passive-container").style.display="none";document.getElementById("akeeba-transfer-ftp-passive-fix-container").style.display="none";document.getElementById("akeeba-transfer-chunkmode").parentNode.style.display="none";document.getElementById("akeeba-transfer-chunksize").parentNode.style.display="none";var c=document.getElementById("akeeba-transfer-ftp-method");var d=c.options[c.selectedIndex].value;if(d=="manual"){document.getElementById("akeeba-transfer-btn-apply").parentNode.style.display="none";document.getElementById("akeeba-transfer-manualtransfer").style.display="grid";return}var b={task:"applyConnection",method:d,host:document.getElementById("akeeba-transfer-ftp-host").value,port:document.getElementById("akeeba-transfer-ftp-port").value,username:document.getElementById("akeeba-transfer-ftp-username").value,password:document.getElementById("akeeba-transfer-ftp-password").value,directory:document.getElementById("akeeba-transfer-ftp-directory").value,passive:document.getElementById("akeeba-transfer-ftp-passive1").checked?1:0,passive_fix:document.getElementById("akeeba-transfer-ftp-passive-fix1").checked?1:0,privateKey:document.getElementById("akeeba-transfer-ftp-privatekey").value,publicKey:document.getElementById("akeeba-transfer-ftp-pubkey").value,chunkMode:document.getElementById("akeeba-transfer-chunkmode").value,chunkSize:document.getElementById("akeeba-transfer-chunksize").value};akeeba.System.doAjax(b,function(g){document.getElementById("akeeba-transfer-apply-loading").style.display="none";if(!g.status){document.getElementById("akeeba-transfer-btn-apply").removeAttribute("disabled");document.getElementById("akeeba-transfer-ftp-method").removeAttribute("disabled");var e=document.getElementById("akeeba-transfer-ftp-error");var h=document.getElementById("akeeba-transfer-ftp-error-body");var f=document.getElementById("akeeba-transfer-ftp-error-force");if(f){f.style.display="none";if(g.ignorable){f.style.display="inline-block"}}h.innerHTML=g.message;e.style.display="block";akeeba.System.triggerEvent(e,"focus");akeeba.Transfer.onTransferMethodChange();return}akeeba.Transfer.uploadKickstart()},function(f){document.getElementById("akeeba-transfer-apply-loading").style.display="none";document.getElementById("akeeba-transfer-btn-apply").removeAttribute("disabled");document.getElementById("akeeba-transfer-ftp-method").removeAttribute("disabled");var e=document.getElementById("akeeba-transfer-ftp-error");var g=document.getElementById("akeeba-transfer-ftp-error-body");g.textContent=Joomla.JText._("COM_AKEEBA_CONFIG_DIRECTFTP_TEST_FAIL");e.style.display="block";akeeba.System.triggerEvent(e,"focus");akeeba.Transfer.onTransferMethodChange()},false,15000)};akeeba.Transfer.uploadKickstart=function(){var a=document.getElementById("akeeba-transfer-upload-lbl-kickstart");var d=document.getElementById("akeeba-transfer-upload-lbl-archive");var f=document.getElementById("akeeba-transfer-upload-error");var c=document.getElementById("akeeba-transfer-upload-error-body");var b=document.getElementById("akeeba-transfer-upload-error-force");f.style.display="none";b.style.display="none";c.innerHTML="";a.className="akeeba-label--orange";d.className="akeeba-label--grey";document.getElementById("akeeba-transfer-upload-area-kickstart").style.display="none";document.getElementById("akeeba-transfer-upload-area-upload").style.display="block";document.getElementById("akeeba-transfer-upload").style.display="block";var e={task:"initialiseUpload"};akeeba.System.doAjax(e,function(g){if(!g.status){if(b){b.style.display="none";if(g.ignorable){b.style.display="inline-block"}}a.className="akeeba-label--red";c.innerHTML=g.message;f.style.display="block";return}akeeba.Transfer.uploadArchive(1)},null,false,150000)};akeeba.Transfer.uploadArchive=function(f){if(f===undefined){f=0}var a=document.getElementById("akeeba-transfer-upload-lbl-kickstart");var c=document.getElementById("akeeba-transfer-upload-lbl-archive");var e=document.getElementById("akeeba-transfer-upload-error");var b=document.getElementById("akeeba-transfer-upload-error-body");b.innerHTML="";e.style.display="none";a.className="akeeba-label--green";c.className="akeeba-label--orange";var d={task:"upload",start:f};akeeba.System.doAjax(d,function(j){if(!j.result){c.className="akeeba-label--red";b.innerHTML=j.message;e.style.display="block";return}if(j.done){document.getElementById("akeeba-transfer-upload-percent").textContent="100 %";document.getElementById("akeeba-transfer-upload-size").innerHTML="";document.getElementById("akeeba-transfer-upload-area-kickstart").style.display="block";document.getElementById("akeeba-transfer-upload-area-upload").style.display="none";var l=document.getElementById("akeeba-transfer-url");var h=l.value.replace(/\/$/,"")+"/kickstart.php";document.getElementById("akeeba-transfer-upload-btn-kickstart").setAttribute("href",h);return}var m=0;var g=j.totalSize*1;var k=j.doneSize*1;if((g>0)&&(k>0)){m=100*(k/g)}document.getElementById("akeeba-transfer-upload-percent").textContent=m.toFixed(2)+"%";document.getElementById("akeeba-transfer-upload-size").textContent=k.toFixed(0)+" / "+g.toFixed(0)+" bytes";window.setTimeout(function(){akeeba.Transfer.uploadArchive(0)},50)},null,false,150000)};akeeba.Transfer.testFtpSftpConnection=function(){var b=document.getElementById("akeeba-transfer-ftp-method");var a=b.options[b.selectedIndex].value;if((a==="ftp")||(a==="ftps")||(a==="ftpcurl")||(a==="ftpscurl")){akeeba.Transfer.FtpTest.testConnection("akeeba-transfer-btn-testftp")}else{if((a==="sftp")||(a==="sftpcurl")){akeeba.Transfer.SftpTest.testConnection("akeeba-transfer-btn-testftp")}}return false};akeeba.System.documentReady(function(){akeeba.System.addEventListener(document.getElementById("akeeba-transfer-ftp-method"),"change",akeeba.Transfer.onTransferMethodChange)});